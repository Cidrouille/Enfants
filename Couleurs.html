<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Jeu des Couleurs</title>
    <link rel="stylesheet" href="Couleurs.css">
</head>
<body>

<!-- Fond animÃ© -->
<div class="background">
    <!-- Bulles -->
    <span class="bubble" style="--size:30px; --left:10%; --duration:12s;"></span>
    <span class="bubble" style="--size:50px; --left:70%; --duration:15s;"></span>
    <span class="bubble" style="--size:40px; --left:40%; --duration:18s;"></span>
    <span class="bubble" style="--size:25px; --left:80%; --duration:10s;"></span>

    <!-- LumiÃ¨res -->
    <span class="lights" style="--size:12px; --left:15%; --duration:8s;"></span>
    <span class="lights" style="--size:10px; --left:45%; --duration:10s;"></span>
    <span class="lights" style="--size:14px; --left:70%; --duration:12s;"></span>
	
	<!-- Etoiles -->
	<span class="star" style="--size:18px; --left:15%; --duration:12s;"></span>
    <span class="star" style="--size:12px; --left:45%; --duration:8s;"></span>
	<span class="star" style="--size:25px; --left:85%; --duration:10s;"></span>
	
	<!-- Lunes -->
	<span class="lune" style="--size:18px; --left:20%; --duration:10s;"></span>
    <span class="lune" style="--size:12px; --left:50%; --duration:15s;"></span>
	<span class="lune" style="--size:25px; --left:90%; --duration:13s;"></span>
	
	<div class="shooting-star" style="--size:25px; --duration:5s; --start-left:0vw; --start-bottom:65%;">
	  <div class="trail"></div>
	  <div class="star-shape"></div>
	</div>
	<div class="shooting-star" style="--size:25px; --duration:6s; --start-left:0vw; --start-bottom:10%;">
	  <div class="trail"></div>
	  <div class="star-shape"></div>
	</div>
	<div class="shooting-star" style="--size:25px; --duration:7s; --start-left:50vw; --start-bottom:0%;">
	  <div class="trail"></div>
	  <div class="star-shape"></div>
	</div>
	
	<div id="cursor-trail"></div>
	
</div>

<header>
	<div class="header-left">
        <button id="goHomeBtn">Changer de jeu</button>
    </div>
    <h1>ðŸŽ¨ Jeu des Couleurs</h1>
    <p>Trouve la bonne couleur !</p>
	
	<div id="cursor-trail"></div>
</header>

<main>
    <div id="colorDisplay"></div>

    <div class="choices">
        <button class="choice"></button>
        <button class="choice"></button>
        <button class="choice"></button>
    </div>

    <p id="message"></p>
    <button id="nextBtn">Couleur suivante â†’</button>
</main>

<script>
const colors = [
    {name:"Rouge", value:"#ff4d4d"},
    {name:"Bleu", value:"#4dabf7"},
	{name:"Bleu clair", value:"#3bc9db"},
    {name:"Vert", value:"#69db7c"},
    {name:"Vert clair", value:"#b9fbc0"},
    {name:"Jaune", value:"#ffd43b"},
    {name:"Orange", value:"#ffa94d"},
    {name:"Violet", value:"#b197fc"},
    {name:"Marron", value:"#8d6e63"},
    {name:"Gris", value:"#adb5bd"},
    {name:"Gris clair", value:"#e0e0e0"},
    {name:"Noir", value:"#343a40"},
    {name:"Blanc", value:"#ffffff"}
];

const display = document.getElementById("colorDisplay");
const buttons = document.querySelectorAll(".choice");
const message = document.getElementById("message");
const nextBtn = document.getElementById("nextBtn");
const goHomeBtn = document.getElementById("goHomeBtn");

let correctColor;

function shuffle(array){
    return array.sort(() => Math.random()-0.5);
}

function newGame(){
    message.textContent = "";
    nextBtn.style.display = "none";

    buttons.forEach(btn=>{
        btn.classList.remove("good","bad","click-anim");
        btn.disabled=false;
    });

    correctColor = colors[Math.floor(Math.random()*colors.length)];
    display.style.background = correctColor.value;

    let choices = [correctColor];
    while(choices.length<3){
        let c = colors[Math.floor(Math.random()*colors.length)];
        if(!choices.includes(c)) choices.push(c);
    }

    choices = shuffle(choices);

    buttons.forEach((btn,i)=>{
        btn.textContent = choices[i].name;
        btn.onclick = ()=>checkAnswer(btn,choices[i]);
    });
}

function checkAnswer(btn,color){
    btn.classList.add("click-anim");
    if(color===correctColor){
        btn.classList.add("good");
        message.textContent="ðŸŽ‰ Bravo ! Bonne rÃ©ponse !";
        nextBtn.style.display="inline-block";

        buttons.forEach(b=>{
            if(b!==btn) b.classList.add("bad");
            b.disabled=true;
        });

    } else {
        btn.classList.add("bad");
        btn.disabled=true;
        message.textContent="âŒ Essaie encore !";
    }
}

nextBtn.onclick=newGame;
newGame();

goHomeBtn.onclick = () => {
    window.location.href = "Accueil.html";
};

// TRAÃŽNÃ‰E ARC-EN-CIEL FLUIDE LÃ‰GÃˆRE
const trailCanvas = document.createElement("canvas");
trailCanvas.style.position = "fixed";
trailCanvas.style.top = "0";
trailCanvas.style.left = "0";
trailCanvas.style.pointerEvents = "none";
trailCanvas.style.zIndex = "9999";
document.body.appendChild(trailCanvas);

const ctx = trailCanvas.getContext("2d");
let width = window.innerWidth;
let height = window.innerHeight;
trailCanvas.width = width;
trailCanvas.height = height;

window.addEventListener("resize", () => {
    width = window.innerWidth;
    height = window.innerHeight;
    trailCanvas.width = width;
    trailCanvas.height = height;
});

let mouseX = width/2;
let mouseY = height/2;
let lastMove = Date.now();

document.addEventListener("mousemove", e => {
    mouseX = e.clientX;
    mouseY = e.clientY;
    lastMove = Date.now();
});

const trail = [];
const maxTrail = 10; // moins de points => traÃ®nÃ©e plus courte

function animateTrailCanvas() {
    ctx.clearRect(0,0,width,height);

    // ajoute la nouvelle position
    trail.push({x: mouseX, y: mouseY, time: Date.now()});
    if(trail.length > maxTrail) trail.shift();

    for(let i=0; i<trail.length-1; i++){
        const p = trail[i];
        const next = trail[i+1];
        const alpha = 0.8 * (1 - i / trail.length); // plus subtil

        const hue = (i*30 + Date.now()/10)%360;
        ctx.strokeStyle = `hsla(${hue},100%,60%,${alpha})`;
        ctx.lineWidth = 6*(alpha); 

        // effet de flou lÃ©ger
        ctx.shadowBlur = 8;
        ctx.shadowColor = ctx.strokeStyle;

        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
        ctx.lineTo(next.x, next.y);
        ctx.stroke();
    }

    // efface si souris immobile > 300ms
    if(Date.now() - lastMove > 300){
        trail.length = 0;
    }

    requestAnimationFrame(animateTrailCanvas);
}

animateTrailCanvas();

</script>

</body>
</html>
